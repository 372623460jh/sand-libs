"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

function _react() {
  const data = _interopRequireDefault(require("react"));

  _react = function _react() {
    return data;
  };

  return data;
}

function _unistUtilVisit() {
  const data = _interopRequireDefault(require("unist-util-visit"));

  _unistUtilVisit = function _unistUtilVisit() {
    return data;
  };

  return data;
}

function _hastUtilToString() {
  const data = _interopRequireDefault(require("hast-util-to-string"));

  _hastUtilToString = function _hastUtilToString() {
    return data;
  };

  return data;
}

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var _default = () => {
  return tree => {
    (0, _unistUtilVisit().default)(tree, 'element', (node, i, parent) => {
      var _node$children, _node$children$;

      if (node.tagName === 'pre' && ((_node$children = node.children) === null || _node$children === void 0 ? void 0 : (_node$children$ = _node$children[0]) === null || _node$children$ === void 0 ? void 0 : _node$children$.tagName) === 'code') {
        var _cls$join$match;

        const cls = node.children[0].properties.className || [];
        const lang = ((_cls$join$match = cls.join('').match(/language-(\w+)(?:$| )/)) === null || _cls$join$match === void 0 ? void 0 : _cls$join$match[1]) || 'unknown';
        parent.children.splice(i, 1, {
          type: 'raw',
          position: node.position,
          value: `<SourceCode code={${JSON.stringify((0, _hastUtilToString().default)(node.children[0]))}} lang=${JSON.stringify(lang)} />`
        });
      }
    });
  };
};

exports.default = _default;